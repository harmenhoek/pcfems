{% extends "ems_manage/manage_base.html" %}
{% block tabmanage2_active %}
active
{% endblock tabmanage2_active %}
{% block manage_submenu %}

<h1 class="h2">Users</h1>
<div class="float-end my-2">
    <a class="btn btn-sm btn-success" href="{% url 'manage-users-add' %}"><i class="fas fa-plus"></i> Add new user</a>
    {% include "ems/help_modal.html" with title="User" help_file="ems_manage/help.html" help_section="user" %}
</div>

{% endblock manage_submenu %}

{% block content %}
{% load ems_customfilters %}




    <div class="row">
        <div class="col col-12">
            <table id="user_list" class="table table-striped table-bordered table w-100" style="width:100%">
                <thead>
                <tr>
                    <th data-priority="10">ID</th>
                    <th data-priority="10">Username</th>
                    <th data-priority="10">First name</th>
                    <th data-priority="10">Last name</th>
                    <th data-priority="10">Email</th>
                    <th data-priority="10">Type</th>
                    <th data-priority="10">Permisssions</th>
                    <th data-priority="10">Status</th>
                    <th data-priority="10">Last login</th>
                    <th data-priority="10">Joined</th>
                    <th data-priority="10">Items</th>
                    <th data-priority="10"></th>
                </tr>
                </thead>
                <tbody>
                {% for item in object_list %}
            <!--    <tr style="cursor:pointer;" onclick="window.location='#';">-->
                <tr>
                    <td>{{ item.pk }}</td>
                    <td>{{ item.username }}</td>
                    <td>{{ item.first_name }}</td>
                    <td>{{ item.last_name }}</td>
                    <td>{{ item.email }}</td>
                    <td>
                        {% if item.profile.is_administrator %}
                            <span class="badge rounded-pill bg-info">Admin</span>
                        {% elif item.is_staff %}
                            <span class="badge rounded-pill bg-info">Staff</span>
                        {% else %}
                            <span class="badge rounded-pill bg-secondary">Normal</span>
                        {% endif %}
                    </td>
                    <td>{# {{ item|check_permission:'is_flagmoderator' }} #}
                        {% for perm in item|get_all_permissions %}
                            <span class="badge pill bg-light text-dark" data-bs-toggle="tooltip" data-bs-placement="bottom" title="{{ perm.1 }}">{{ perm.0 }}</span>
                        {% endfor %}

                    </td>
                    <td>
                        {% if item.is_active %}
                            <span class="badge rounded-pill bg-success">Active</span>
                        {% else %}
                            <span class="badge rounded-pill bg-danger">Inactive</span>
                        {% endif %}
                    </td>
                    <td>{{ item.last_login|date:"Y-m-d G:i:s" }}</td>
                    <td>{{ item.date_joined|date:"Y-m-d G:i:s" }}</td>
                    <td>{{ item.num_items }}</td>
                    <td>
                        {% if item.is_superuser %}
                            <a href="{% url 'manage-users-update' item.pk %}" class="btn btn-sm btn-secondary disabled">Edit</a>
                        {% else %}
                            <a href="{% url 'manage-users-update' item.pk %}" class="btn btn-sm btn-secondary">Edit</a>
                        {% endif %}
                    </td>

                </tr>
                {% endfor %}
                </tbody>
            </table>
        </div> <!-- col -->
    </div> <!-- row -->

{% endblock content %}

{% block tablescript %}
{# Code block for javascript table #}

<script>
    $(document).ready(function() {
        $('#user_list').DataTable( {
            "scrollX": true
        } );
    } );
</script>

{% endblock tablescript %}
